<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[小红博客]]></title>
  <link href="http://weixuhong.com/atom.xml" rel="self"/>
  <link href="http://weixuhong.com/"/>
  <updated>2015-03-06T13:16:28+08:00</updated>
  <id>http://weixuhong.com/</id>
  <author>
    <name><![CDATA[Weston Wei(韦旭红)]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Postgresql 分组查询]]></title>
    <link href="http://weixuhong.com/blog/2014/12/27/postgresql-fen-zu-cha-xun/"/>
    <updated>2014-12-27T14:47:01+08:00</updated>
    <id>http://weixuhong.com/blog/2014/12/27/postgresql-fen-zu-cha-xun</id>
    <content type="html"><![CDATA[<h3 id="section">数据</h3>
<p>最近有一个项目，有一个表数据结构如下</p>

<table class="table">
<thead>
<tr>
  <td>name</td>
  <td>description</td>
  <td> technique_id </td>
  <td>references_count</td>
</tr>
</thead>
<tbody>
<tr>
  <td>name_1</td>
  <td>description</td>
  <td>1</td>
  <td>5</td>
</tr>

<tr>
  <td>name_2</td>
  <td>description</td>
  <td>2</td>
  <td>4</td>
</tr>

<tr>
  <td>name_3</td>
  <td>description</td>
  <td>3</td>
  <td>2</td>
</tr>

<tr>
  <td>name_1</td>
  <td>description</td>
  <td>1</td>
  <td>5</td>
</tr>

<tr>
  <td>name_2</td>
  <td>description</td>
  <td>2</td>
  <td>4</td>
</tr>

<tr>
  <td>name_3</td>
  <td>description</td>
  <td>3</td>
  <td>2</td>
</tr>

<tr>
  <td>name_1</td>
  <td>description</td>
  <td>1</td>
  <td>5</td>
</tr>

<tr>
  <td>name_2</td>
  <td>description</td>
  <td>2</td>
  <td>4</td>
</tr>

<tr>
  <td>name_3</td>
  <td>description</td>
  <td>3</td>
  <td>2</td>
</tr>


</tbody>
</table>

<h3 id="section-1">需求</h3>
<p><strong>现在需要通过一条sql语句， 通过几个 technique_id 查找， 每个technique_id 查找3条， 并且按照references_count降序</strong></p>

<h3 id="section-2">实现</h3>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
</pre></td><td class="code"><pre><code class="sql"><span class="line"><span class="k">SELECT</span> <span class="o">*</span> <span class="k">from</span> <span class="p">(</span>
</span><span class="line">  <span class="k">SELECT</span> <span class="o">*</span><span class="p">,</span> <span class="n">RANK</span><span class="p">()</span> <span class="n">OVER</span> <span class="p">(</span><span class="n">PARTITION</span> <span class="k">BY</span> <span class="n">technique_id</span> <span class="k">ORDER</span> <span class="k">BY</span> <span class="n">reference_count</span> <span class="k">DESC</span><span class="p">)</span> <span class="k">AS</span> <span class="n">RP</span> <span class="k">FROM</span> <span class="n">gauges</span>
</span><span class="line"><span class="p">)</span>
</span><span class="line"><span class="k">G</span> <span class="k">WHERE</span> <span class="k">G</span><span class="p">.</span><span class="n">rp</span> <span class="o">&lt;=</span> <span class="mi">3</span><span class="err">&quot;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<h3 id="section-3">参考</h3>

<p><a href="http://thehobt.blogspot.jp/2009/02/rownumber-rank-and-denserank.html">http://thehobt.blogspot.jp/2009/02/rownumber-rank-and-denserank.html</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Rspec 3 重要更新]]></title>
    <link href="http://weixuhong.com/blog/2014/10/28/rspec-3-zhong-yao-geng-xin/"/>
    <updated>2014-10-28T18:12:33+08:00</updated>
    <id>http://weixuhong.com/blog/2014/10/28/rspec-3-zhong-yao-geng-xin</id>
    <content type="html"><![CDATA[<p>参考这里:<a href="http://myronmars.to/n/dev-blog/2014/05/notable-changes-in-rspec-3">http://myronmars.to/n/dev-blog/2014/05/notable-changes-in-rspec-3</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Knife-solo 初探]]></title>
    <link href="http://weixuhong.com/blog/2014/10/28/knife-solo-chu-tan/"/>
    <updated>2014-10-28T10:22:06+08:00</updated>
    <id>http://weixuhong.com/blog/2014/10/28/knife-solo-chu-tan</id>
    <content type="html"><![CDATA[<h1 id="section">写在前面的话</h1>

<p>做了多年的项目， 一直使用<a href="http://capistranorb.com">capistrano</a>发布项目, 这个确实带来很大的便利。但是有点比较麻烦的地方，就是每次部署新的服务器，都像做苦力一样，去安装服务器的环境，后来了解到Chef和knife-solo, 其就可以达到类似capistrano所作的事情， 不过一个是一键发布项目，一个是一键安装服务器环境，好了，让我们开始吧！</p>

<h1 id="section-1">准备工作</h1>

<p>我们需要一台测试服务器，这个我们需要Vagrant帮我们实现。</p>

<h2 id="vagrant">安装vagrant</h2>

<ol>
  <li>
    <p>先到这里下载Vagrant : https://www.vagrantup.com/downloads.html
&gt; 注意： 旧的版本是通过gem install vagrant 安装</p>
  </li>
  <li>
    <p>安装box</p>
  </li>
</ol>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="bash"><span class="line">vagrant init hashicorp/precise32
</span></code></pre></td></tr></table></div></figure></notextile></div>
<blockquote>
  <p>到这里发现更多的box: http://vagrantcloud.com</p>
</blockquote>

<ol>
  <li>启动</li>
</ol>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="bash"><span class="line">vagrant up
</span></code></pre></td></tr></table></div></figure></notextile></div>
<ol>
  <li>配置ssh登录不需要密码</li>
</ol>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="bash"><span class="line">vagrant ssh-config --host   服务器IP &gt;&gt; ~/.ssh/config
</span></code></pre></td></tr></table></div></figure></notextile></div>
<p>## 安装chef-solo</p>

<ol>
  <li>安装chef 和 chef-solo</li>
</ol>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
</pre></td><td class="code"><pre><code class="bash"><span class="line">gem install chef
</span><span class="line">gem install knife-solo
</span><span class="line">或者
</span><span class="line">bundle init
</span><span class="line">编辑Gemfile
</span><span class="line">添加:
</span><span class="line"><span class="nb">source</span> <span class="s2">&quot;https://rubygems.org&quot;</span>
</span><span class="line">gem <span class="s2">&quot;knife-solo&quot;</span>
</span><span class="line">执行:
</span><span class="line">bundle install --path<span class="o">=</span>vendor/bundle
</span></code></pre></td></tr></table></div></figure></notextile></div>

<ol>
  <li>初始化knife-solo项目</li>
</ol>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
</pre></td><td class="code"><pre><code class="bash"><span class="line">knife solo init chef-repo
</span><span class="line"><span class="nb">cd </span>chef-repo
</span><span class="line">git init
</span><span class="line">git commit -a -m <span class="s2">&quot;initial commit&quot;</span>
</span><span class="line">knife solo prepare ServerIP --bootstrap-version 11.12.0 <span class="c"># 如果这里不指定版本号， 会提示找不到文件的错误</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>
<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
</pre></td><td class="code"><pre><code class="bash"><span class="line">需要指定这个版本号 --bootstrap-version 11.12.0 <span class="c"># 如果这里不指定版本号， 会提示找不到文件的错误</span>
</span><span class="line">wnloading Chef 12.0.0.alpha.2 <span class="k">for</span> ubuntu...
</span><span class="line">downloading https://www.opscode.com/chef/metadata?v<span class="o">=</span>12.0.0.alpha.2<span class="p">&amp;</span><span class="nv">prerelease</span><span class="o">=</span><span class="nb">false</span><span class="p">&amp;</span><span class="nv">nightlies</span><span class="o">=</span><span class="nb">false</span><span class="p">&amp;</span><span class="nv">p</span><span class="o">=</span>ubuntu<span class="p">&amp;</span><span class="nv">pv</span><span class="o">=</span>12.04<span class="p">&amp;</span><span class="nv">m</span><span class="o">=</span>i686
</span><span class="line">  to file /tmp/install.sh.5074/metadata.txt
</span><span class="line">trying wget...
</span><span class="line">ERROR 404
</span><span class="line">Unable to retrieve a valid package!
</span><span class="line">Please file a bug report at http://tickets.opscode.com
</span><span class="line">Project: Chef
</span><span class="line">Component: Packages
</span><span class="line">Label: Omnibus
</span><span class="line">Version: 12.0.0.alpha.2
</span><span class="line">Please detail your operating system <span class="nb">type</span>, version and any other relevant details
</span><span class="line">Metadata URL: https://www.opscode.com/chef/metadata?v<span class="o">=</span>12.0.0.alpha.2<span class="p">&amp;</span><span class="nv">prerelease</span><span class="o">=</span><span class="nb">false</span><span class="p">&amp;</span><span class="nv">nightlies</span><span class="o">=</span><span class="nb">false</span><span class="p">&amp;</span><span class="nv">p</span><span class="o">=</span>ubuntu<span class="p">&amp;</span><span class="nv">pv</span><span class="o">=</span>12.04<span class="p">&amp;</span><span class="nv">m</span><span class="o">=</span>i686
</span></code></pre></td></tr></table></div></figure></notextile></div>

<h1 id="knife-solo-nginx">通过Knife Solo 安装Nginx</h1>

<ol>
  <li>生成模板文件</li>
</ol>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="bash"><span class="line">knife cookbook create nginx -o site-cookbooks
</span></code></pre></td></tr></table></div></figure></notextile></div>

<ol>
  <li>编辑模板</li>
</ol>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
</pre></td><td class="code"><pre><code class="ruby"><span class="line"><span class="n">site</span><span class="o">-</span><span class="n">cookbooks</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">recipes</span><span class="o">/</span><span class="n">default</span><span class="o">.</span><span class="n">rb</span>
</span><span class="line"><span class="n">package</span> <span class="s2">&quot;nginx&quot;</span> <span class="k">do</span>
</span><span class="line">    <span class="n">action</span> <span class="ss">:install</span>
</span><span class="line"><span class="k">end</span>
</span><span class="line"><span class="n">service</span> <span class="s2">&quot;nginx&quot;</span> <span class="k">do</span>
</span><span class="line">    <span class="n">supports</span> <span class="ss">:status</span> <span class="o">=&gt;</span> <span class="kp">true</span><span class="p">,</span> <span class="ss">:restart</span> <span class="o">=&gt;</span> <span class="kp">true</span><span class="p">,</span> <span class="ss">:reload</span> <span class="o">=&gt;</span> <span class="kp">true</span>
</span><span class="line">    <span class="n">action</span> <span class="o">[</span><span class="ss">:enable</span><span class="p">,</span> <span class="ss">:start</span><span class="o">]</span>
</span><span class="line"><span class="k">end</span>
</span><span class="line"><span class="n">template</span> <span class="s2">&quot;nginx.conf&quot;</span> <span class="k">do</span>
</span><span class="line">    <span class="n">path</span> <span class="s2">&quot;/etc/nginx/nginx.conf&quot;</span>
</span><span class="line">    <span class="n">source</span> <span class="s2">&quot;nginx.conf.erb&quot;</span>
</span><span class="line">    <span class="n">owner</span> <span class="s2">&quot;root&quot;</span>
</span><span class="line">    <span class="n">group</span> <span class="s2">&quot;root&quot;</span>
</span><span class="line">    <span class="n">mode</span> <span class="mo">0644</span>
</span><span class="line">    <span class="n">notifies</span> <span class="ss">:reload</span> <span class="p">,</span> <span class="s2">&quot;service[nginx]&quot;</span>
</span><span class="line"><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
</pre></td><td class="code"><pre><code class="ruby"><span class="line"><span class="n">user</span> <span class="n">vagrant</span><span class="p">;</span>  <span class="c1"># 这里可以用nginx，但是需要新建这个用户</span>
</span><span class="line"><span class="n">worker_processes</span>    <span class="mi">1</span><span class="p">;</span>
</span><span class="line"><span class="n">error_log</span>   <span class="sr">/var/</span><span class="n">log</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">error</span><span class="o">.</span><span class="n">log</span><span class="p">;</span>
</span><span class="line"><span class="n">pid</span> <span class="sr">/var/</span><span class="n">run</span><span class="o">/</span><span class="n">nginx</span><span class="o">.</span><span class="n">pid</span><span class="p">;</span>
</span><span class="line"><span class="n">events</span> <span class="p">{</span>
</span><span class="line">    <span class="n">worker_connections</span> <span class="mi">1024</span><span class="p">;</span>
</span><span class="line"><span class="p">}</span>
</span><span class="line"><span class="n">http</span> <span class="p">{</span>
</span><span class="line">    <span class="kp">include</span> <span class="sr">/etc/n</span><span class="n">ginx</span><span class="o">/</span><span class="n">mime</span><span class="o">.</span><span class="n">types</span><span class="p">;</span>
</span><span class="line">    <span class="n">default_type</span> <span class="n">application</span><span class="o">/</span><span class="n">octet</span><span class="o">-</span><span class="n">stream</span><span class="p">;</span>
</span><span class="line">    <span class="n">server</span> <span class="p">{</span>
</span><span class="line">        <span class="n">listen</span> <span class="o">&lt;%=</span> <span class="n">node</span><span class="o">[</span><span class="s1">&#39;nginx&#39;</span><span class="o">][</span><span class="s1">&#39;port&#39;</span><span class="o">]</span> <span class="o">%&gt;</span><span class="p">;</span>
</span><span class="line">        <span class="n">server_name</span> <span class="n">localhost</span><span class="p">;</span>
</span><span class="line">        <span class="n">location</span> <span class="o">/</span> <span class="p">{</span>
</span><span class="line">            <span class="n">root</span> <span class="sr">/usr/s</span><span class="n">hare</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">html</span><span class="p">;</span>
</span><span class="line">            <span class="n">index</span> <span class="n">index</span><span class="o">.</span><span class="n">html</span> <span class="n">index</span><span class="o">.</span><span class="n">htm</span><span class="p">;</span>
</span><span class="line">        <span class="p">}</span>
</span><span class="line">    <span class="p">}</span>
</span><span class="line"><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<ol>
  <li>在服务器上安装nginx</li>
</ol>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="bash"><span class="line">knife solo cook SERVER_IP
</span></code></pre></td></tr></table></div></figure></notextile></div>

<h1 id="section-2">参考</h1>

<ol>
  <li>http://qiita.com/torufurukawa/items/e20bdb9791c49d00672e</li>
  <li>http://gogojimmy.net/2013/06/01/Chef-Solo-Basic-with-Vagrant/</li>
  <li>https://docs.vagrantup.com/v2/getting-started/index.html</li>
  <li>http://vagrantcloud.com</li>
</ol>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Rspec 新旧方法对照表]]></title>
    <link href="http://weixuhong.com/blog/2014/10/24/rspec-xin-jiu-fang-fa-dui-zhao-biao/"/>
    <updated>2014-10-24T10:33:47+08:00</updated>
    <id>http://weixuhong.com/blog/2014/10/24/rspec-xin-jiu-fang-fa-dui-zhao-biao</id>
    <content type="html"><![CDATA[<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class="ruby"><span class="line"><span class="n">obj</span><span class="o">.</span><span class="n">should</span> <span class="o">.</span><span class="n">.</span><span class="o">.</span>
</span><span class="line"><span class="n">expect</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span><span class="o">.</span><span class="n">to</span> <span class="o">.</span><span class="n">.</span><span class="o">.</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>
<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class="ruby"><span class="line"><span class="n">obj</span><span class="o">.</span><span class="n">should_not</span> <span class="o">.</span><span class="n">.</span><span class="o">.</span>
</span><span class="line"><span class="n">expect</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span><span class="o">.</span><span class="n">not_to</span> <span class="o">.</span><span class="n">.</span><span class="o">.</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>
<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class="ruby"><span class="line"><span class="n">obj</span><span class="o">.</span><span class="n">should</span> <span class="o">=~</span> <span class="sr">//</span>
</span><span class="line"><span class="n">expect</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span><span class="o">.</span><span class="n">to</span> <span class="n">match</span><span class="p">(</span><span class="sr">//</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>
<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class="ruby"><span class="line"><span class="o">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="o">].</span><span class="n">should</span> <span class="o">=~</span> <span class="o">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="o">]</span>
</span><span class="line"><span class="n">expect</span><span class="p">(</span><span class="o">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="o">]</span><span class="p">)</span><span class="o">.</span><span class="n">to</span> <span class="n">match_array</span><span class="p">(</span><span class="o">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="o">]</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>
<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class="ruby"><span class="line"><span class="n">obj</span><span class="o">.</span><span class="n">should</span> <span class="o">&gt;</span> <span class="mi">3</span>
</span><span class="line"><span class="n">expect</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span><span class="o">.</span><span class="n">to</span> <span class="n">be</span> <span class="o">&gt;</span> <span class="mi">3</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>
<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class="ruby"><span class="line"><span class="nb">lambda</span> <span class="p">{</span> <span class="o">.</span><span class="n">.</span><span class="o">.</span> <span class="p">}</span><span class="o">.</span><span class="n">should</span> <span class="n">raise_error</span>
</span><span class="line"><span class="n">expect</span> <span class="p">{</span> <span class="o">.</span><span class="n">.</span><span class="o">.</span> <span class="p">}</span><span class="o">.</span><span class="n">to</span> <span class="n">raise_error</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<h2 id="rspec-2140-or-later">RSpec 2.14.0 or later</h2>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class="ruby"><span class="line"><span class="n">obj</span><span class="o">.</span><span class="n">stub</span><span class="p">(</span><span class="ss">:foo</span><span class="p">)</span>
</span><span class="line"><span class="n">allow</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span><span class="o">.</span><span class="n">to</span> <span class="n">receive</span><span class="p">(</span><span class="ss">:foo</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>
<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class="ruby"><span class="line"><span class="no">SomeClass</span><span class="o">.</span><span class="n">any_instance</span><span class="o">.</span><span class="n">should_receive</span><span class="p">(</span><span class="ss">:foo</span><span class="p">)</span>
</span><span class="line"><span class="n">expect_any_instance_of</span><span class="p">(</span><span class="no">SomeClass</span><span class="p">)</span><span class="o">.</span><span class="n">to</span> <span class="n">receive</span><span class="p">(</span><span class="ss">:foo</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>
<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class="ruby"><span class="line"><span class="no">SomeClass</span><span class="o">.</span><span class="n">any_instance</span><span class="o">.</span><span class="n">stub</span><span class="p">(</span><span class="ss">:foo</span><span class="p">)</span>
</span><span class="line"><span class="n">allow_any_instance_of</span><span class="p">(</span><span class="no">SomeClass</span><span class="p">)</span><span class="o">.</span><span class="n">to</span> <span class="n">receive</span><span class="p">(</span><span class="ss">:foo</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<h2 id="rspec-2990beta1-or-later">RSpec 2.99.0.beta1 or later</h2>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class="ruby"><span class="line"><span class="n">it</span> <span class="p">{</span> <span class="n">should</span> <span class="n">eq</span><span class="p">(</span><span class="n">something</span><span class="p">)</span> <span class="p">}</span>
</span><span class="line"><span class="n">it</span> <span class="p">{</span> <span class="n">is_expected</span><span class="o">.</span><span class="n">to</span> <span class="n">eq</span><span class="p">(</span><span class="n">something</span><span class="p">)</span> <span class="p">}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<h2 id="rspec-300beta1-or-later">RSpec 3.0.0.beta1 or later</h2>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class="ruby"><span class="line"><span class="n">obj</span><span class="o">.</span><span class="n">stub_chain</span><span class="p">(</span><span class="ss">:foo</span><span class="p">,</span> <span class="ss">:bar</span><span class="p">)</span><span class="o">.</span><span class="n">and_return</span><span class="p">(</span><span class="n">something</span><span class="p">)</span>
</span><span class="line"><span class="n">allow</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span><span class="o">.</span><span class="n">to</span> <span class="n">receive_message_chain</span><span class="p">(</span><span class="ss">:foo</span><span class="p">,</span> <span class="ss">:bar</span><span class="p">)</span><span class="o">.</span><span class="n">and_return</span><span class="p">(</span><span class="n">something</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Rubymine 不能输入中文？]]></title>
    <link href="http://weixuhong.com/blog/2014/10/23/rubymine-bu-neng-shu-ru-zhong-wen-%3F/"/>
    <updated>2014-10-23T10:14:26+08:00</updated>
    <id>http://weixuhong.com/blog/2014/10/23/rubymine-bu-neng-shu-ru-zhong-wen-?</id>
    <content type="html"><![CDATA[<p>如果你的rubymine 不能输入中文，请做这样的修改:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="bash"><span class="line"> vim /Applications/RubyMine.app/bin/idea.vmoptions
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>加入下面一行：
&lt;div class=&#8217;bogus-wrapper&#8217;&gt;<notextile><figure class="code">&lt;figcaption&gt;<span></span>&lt;/figcaption&gt;&lt;div class=&#8221;highlight&#8221;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#8221;gutter&#8221;&gt;&lt;pre class=&#8221;line-numbers&#8221;&gt;<span class="line-number">1</span>
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#8217;code&#8217;&gt;&lt;pre&gt;<code class="java"><span class="line"><span class="o">-</span><span class="n">J</span><span class="o">-</span><span class="n">Djava</span><span class="o">.</span><span class="na">awt</span><span class="o">.</span><span class="na">im</span><span class="o">.</span><span class="na">style</span><span class="o">=</span><span class="n">on</span><span class="o">-</span><span class="n">the</span><span class="o">-</span><span class="n">spot</span>
</span></code>&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;</figure></notextile>&lt;/div&gt;
所以长得这样子:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
</pre></td><td class="code"><pre><code class="java"><span class="line"><span class="o">-</span><span class="n">Xms128m</span>
</span><span class="line"><span class="o">-</span><span class="n">Xmx512m</span>
</span><span class="line"><span class="o">-</span><span class="nl">XX:</span><span class="n">MaxPermSize</span><span class="o">=</span><span class="mi">250</span><span class="n">m</span>
</span><span class="line"><span class="o">-</span><span class="nl">XX:</span><span class="o">+</span><span class="n">UseCompressedOops</span>
</span><span class="line"><span class="o">-</span><span class="n">J</span><span class="o">-</span><span class="n">Djava</span><span class="o">.</span><span class="na">awt</span><span class="o">.</span><span class="na">im</span><span class="o">.</span><span class="na">style</span><span class="o">=</span><span class="n">on</span><span class="o">-</span><span class="n">the</span><span class="o">-</span><span class="n">spot</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>–EOF–</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[看了解AngularJs的指令中的@,=]]></title>
    <link href="http://weixuhong.com/blog/2014/10/22/kan-liao-jie-angularjsde-zhi-ling-zhong-de-at-equals/"/>
    <updated>2014-10-22T18:08:15+08:00</updated>
    <id>http://weixuhong.com/blog/2014/10/22/kan-liao-jie-angularjsde-zhi-ling-zhong-de-at-equals</id>
    <content type="html"><![CDATA[<h3 id="attribute-isolated-scope">Attribute Isolated Scope</h3>

<p>Defined with an @ symbol
Binds a local scope property to the value of a DOM attribute The binding is uni-directional from parent to directive
The result is always a string because DOM attributes are strings</p>

<p><img src="http://weixuhong.com/images/directive_1.png" width="600" title="image" alt="images" /></p>

<h3 id="binding-isolated-scope">Binding Isolated Scope</h3>

<p>Defined with an = symbol
Bi-directional binding between parent and directive You can define the binding as optional via =? Optimal for dealing with objects and collections</p>

<p><img src="http://weixuhong.com/images/directive_2.png" width="600" title="image" alt="images" /></p>

<h3 id="expression-isolated-scope">Expression Isolated Scope</h3>

<p>Defined using an &amp; symbol
Allows you to execute an expression on the parent scope To pass variables from child to parent expressions you must use an object map</p>

<p><img src="http://weixuhong.com/images/directive_3.png" width="600" title="image" alt="images" /></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[为AngularJs的Service 是单例？]]></title>
    <link href="http://weixuhong.com/blog/2014/10/22/wei-angularjsde-service-shi-dan-li-%3F/"/>
    <updated>2014-10-22T17:56:48+08:00</updated>
    <id>http://weixuhong.com/blog/2014/10/22/wei-angularjsde-service-shi-dan-li-?</id>
    <content type="html"><![CDATA[<p><img class="left" src="http://weixuhong.com/images/anguarjs-service.png" width="7" /></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[为什么说AngularJs的Service是单例？]]></title>
    <link href="http://weixuhong.com/archives/602"/>
    <updated>2014-10-21T00:00:00+08:00</updated>
    <id>http://weixuhong.com/archives/%e4%b8%ba%e4%bb%80%e4%b9%88%e8%af%b4angularjs%e7%9a%84service%e6%98%af%e5%8d%95%e4%be%8b%ef%bc%9f</id>
    <content type="html"><![CDATA[<p>看这张图够清楚了吧!</p>

<p>转载请注明：<a href="http://www.weixuhong.com">韦旭红的点点滴滴</a> » <a href="http://www.weixuhong.com/archives/602">为什么说AngularJs的Service是单例？</a></p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Rubymine 不能输入中文？]]></title>
    <link href="http://weixuhong.com/archives/595"/>
    <updated>2014-05-07T00:00:00+08:00</updated>
    <id>http://weixuhong.com/archives/rubymine-%e4%b8%8d%e8%83%bd%e8%be%93%e5%85%a5%e4%b8%ad%e6%96%87%ef%bc%9f</id>
    <content type="html"><![CDATA[<p>如果你的rubymine 不能输入中文，请做这样的修改:</p>

<p> </p>

<p>vim /Applications/RubyMine.app/bin/idea.vmoptions</p>

<p> </p>

<p>加入下面一行：</p>

<p> </p>

<p>-J-Djava.awt.im.style=on-the-spot</p>

<p>所以长得这样子:</p>

<p>-Xms128m<br />
-Xmx512m<br />
-XX:MaxPermSize=250m<br />
-XX:+UseCompressedOops<br />
-J-Djava.awt.im.style=on-the-spot</p>

<p> </p>

<p>–EOF–</p>

<p>转载请注明：<a href="http://www.weixuhong.com">韦旭红的点点滴滴</a> » <a href="http://www.weixuhong.com/archives/595">rubymine 不能输入中文？</a></p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[推荐一个高质量的技术博客]]></title>
    <link href="http://weixuhong.com/archives/593"/>
    <updated>2014-04-25T00:00:00+08:00</updated>
    <id>http://weixuhong.com/archives/%e6%8e%a8%e8%8d%90%e4%b8%80%e4%b8%aa%e9%ab%98%e8%b4%a8%e9%87%8f%e7%9a%84%e6%8a%80%e6%9c%af%e5%8d%9a%e5%ae%a2</id>
    <content type="html"><![CDATA[<p>http://www.integralist.co.uk</p>

<p> </p>

<p>这个博客的内容主要涉及VIM, OOD, Refactor, 特别是Refactor的部分，值得好好研读.</p>

<p>转载请注明：<a href="http://www.weixuhong.com">韦旭红的点点滴滴</a> » <a href="http://www.weixuhong.com/archives/593">推荐一个高质量的技术博客</a></p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[马尔代夫－卡尼岛(Kani)]]></title>
    <link href="http://weixuhong.com/archives/591"/>
    <updated>2013-05-05T00:00:00+08:00</updated>
    <id>http://weixuhong.com/archives/%e9%a9%ac%e5%b0%94%e4%bb%a3%e5%a4%ab%ef%bc%8d%e5%8d%a1%e5%b0%bc%e5%b2%9b</id>
    <content type="html"><![CDATA[<p>值得再去一次的地方, 吃的喝的都免费</p>

<p>离4月19日度假归来已经4天， 但是一回到家，就伴随着耳鸣、咳嗽，流鼻涕、全身乏力， 一直到今天还是如此;-(， 相当难受！</p>

<p>虽然归来已经几天，但是想到在那宛如天堂的地方， 都会不由自主的发自内心的笑…</p>

<p>我们这次的目的地是马尔代夫卡尼岛（参考:</p>

<p>http://baike.baidu.com/view/481080.htm</p>

<p>）， 行程为6日4晚， 意思就是两天在飞机， 4天在岛上。</p>

<p><img src="http://weixuhong.com/content/uploads/psu-2.jpeg" alt="" />  </p>

<p><img src="http://weixuhong.com/content/uploads/psu.jpeg" alt="" />  </p>

<p><img src="http://weixuhong.com/content/uploads/psu-3.jpeg" alt="" />  </p>

<p><img src="http://weixuhong.com/content/uploads/psu-4.jpeg" alt="" />  </p>

<p><img src="http://weixuhong.com/content/uploads/psu-5.jpeg" alt="" />  </p>

<p><img src="http://weixuhong.com/content/uploads/psu-6.jpeg" alt="" />  </p>

<p><img src="http://weixuhong.com/content/uploads/psu-7.jpeg" alt="" />  </p>

<p><img src="http://weixuhong.com/content/uploads/psu-8.jpeg" alt="" />  </p>

<p>我们4月14日启程， 刚开始不顺利， 早上我闹钟不醒， 我没有洗漱就出门， 接着是我的Parter 忘记带了护照， 还好有磁悬浮， 最终我们顺利赶到机场， 乘坐新加坡航空飞6个小时到新加坡，然后等7个小时， 再从新加坡飞4个小时到达马尔代夫马累机场，然后坐30分钟的船， 晚上10点（北京时间4月15日凌晨1点）到达卡尼岛。 </p>

<p>因为到达岛上已经晚上10点多， 我们放好行李，就直奔岛上的酒吧喝酒了， 在海边，享受海风， 端着酒，抽着烟， 就这样开始我们的卡尼岛度假了…</p>

<p>一早起来， 去吃完丰盛的早餐，然后去参加台湾姑娘G.O关于岛上 活动的说明会， 岛上的很多活动都是免费的， 当然包括吃的。我们今天的计划是去浮潜， 参加测试后， 工作人员发给我们工具， 然后坐船离岛10分钟的路程， 带好潜水用具，就到海里看鱼了。</p>

<p>由于是第一次潜水，还不是很熟悉， 而且海浪比较大， 一不小心，我的相机掉到海里了;(, 有些郁闷， 不过遨游在海里， 谁会介意这些小事？看着海中哪些以前只有电视看到的漂亮的鱼， 你会觉得爽呆了…</p>

<p>图片</p>

<p>浮潜45分钟后，我们就返回岛上了， 我们到游泳池占了两个位置， 点了饮料（当然都是免费的）， 就开始边游泳，边看晒太阳，看着远处的美景。岛上以欧美人比较多，特别是法国人，其次有来自中国大陆，台湾、香港，泰国，韩国、日本等国家，也许欧美人享受习惯了， 他们或许都是以生活为主， 感觉这就是他们的生活。他们是不介意阳光爆晒的。晚上7:30开饭， 有意大利菜，法国菜，泰国菜，中国菜，很多点心。</p>

<p>接着晚上9:30，是岛上每天都举行的主题晚会，一直到11点多，一天的行程结束了。</p>

<p>16日</p>

<p>因为前一天已经玩的太累， 这天主要是环岛游，划船，帆船，游泳池晒太阳为主。晚上还是酒吧…</p>

<p>17日</p>

<p>今天就要搬去水上屋，所以一大早起来，就直接在游泳池等了，下午2点钟才搬过去。水上屋有专门的保安，一进去才知道那才是整个岛的精华所在，我震撼了。吃的、住的都比外面高一个级别啊。 水上屋才有免费的WIFI，吧台精致的点心，各种饮料等等。屋下面，可以直接游泳，看鱼，或者看远方的美景。一切是那么的和谐。需要注意的是14岁以下的小孩是不可以住水上屋的。 晚上还可以看到魔鬼鱼。屋内也准备了香槟、咖啡，放着CD，早餐有服务员送来，终于感受到了什么叫做被服务了，原来这才是生活啊。 至少我再一次被震撼了，即使住怎么样的5星级酒店都感觉不如卡尼岛的水上屋啊， 因为那种风景是一般的酒店没有的。</p>

<p>18日</p>

<p>因为今天离岛时间，但是要等到晚上8:25分， 所以今天我们的计划还是浮潜， 因为今天涨潮，又看到了之前没有看到的鱼，收获颇丰啊。</p>

<p>图片</p>

<p>晚上8:25分，在卡尼岛G.O的热情欢送下，我们去了马尔代夫机场。 晚上11:25的航班， 飞了4个小时，到达新加坡机场，候机2个小时， 再飞6个小时，北京时间4月19日15点钟， 到达上海浦东国际机场，旅程结束。</p>

<p>推荐</p>

<p>水上屋</p>

<p>tips：</p>

<p>那里是岛上的精华，记得保安说过，之前有一个法国人，包了岛上的全部水上屋，住了两个星期。</p>

<p>西餐</p>

<p>岛上的西餐厅，需要提前一天预定， 但是那是免费的</p>

<p>浮潜</p>

<p>浮潜可以看到很多漂亮的鱼，还有珊瑚，那时其他地方没有的。且也是免费的。</p>

<p>其他</p>

<p>如果到那个地方， 就不要带伞去了，那里就是去晒太阳的。如果不会讲英文，岛上有讲中文的G.O, 他们大部分来自台湾。好像大陆有一个。 </p>

<p>不要在岛上买东西了，一个打火机就两美金，其他东西贵到什么程度呢？</p>

<p>其实文中叙述的，都不能道出在那边的感受的十分之一， 而且很重要的一点，那里中国人很少， 你不会看到不和谐的事情发生。</p>

<p>–EOF–</p>

<p>转载请注明：<a href="http://www.weixuhong.com">韦旭红的点点滴滴</a> » <a href="http://www.weixuhong.com/archives/591">马尔代夫－卡尼岛(Kani)</a></p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[关于backbone _.bindAll]]></title>
    <link href="http://weixuhong.com/archives/563"/>
    <updated>2011-10-13T00:00:00+08:00</updated>
    <id>http://weixuhong.com/archives/%e5%85%b3%e4%ba%8ebackbone-_-bindall</id>
    <content type="html"><![CDATA[<pre lang="javasript">_.bindAll(this, 'render');
			this.model.bind('change', this.render);

</pre>

<p>以上这两行代码主要为了当model改变时， view执行render， 那_.bindAll有什么用呢？</p>

<p>看这里：http://stackoverflow.com/questions/6079055/why-do-bindall-in-backbone-js-views</p>

<p>其中有一段是这样的：</p>

<pre>Without _.bindAll( this, 'render' ) when model changes this in render will be pointing to the model, not to the view, so we won't have neither this.el nor this.$ or any other view's properties available.
</pre>

<p>当model被change时， this指向model, 但是我们要执行render, 那么就需要_.bindAll(this, ‘render’)， 使model也有这个render的方法？</p>

<p>请达人解答?</p>

<ul>
  <li>新版本这样就可以</li>
</ul>

<p>this.model.bind(‘change’, this.render, this);</p>

<p><img style="display:block; margin-left:auto; margin-right:auto;" src="http://www.weixuhong.com/content/uploads/2011/10/Screen-Shot-2011-10-14-at-1.55.50-PM.png" alt="Screen Shot 2011-10-14 at 1.55.50 PM.png" border="0" width="406" height="567" /></p>

<p><img style="display:block; margin-left:auto; margin-right:auto;" src="http://www.weixuhong.com/content/uploads/2011/10/Screen-Shot-2011-10-14-at-2.06.54-PM.png" alt="Screen Shot 2011-10-14 at 2.06.54 PM.png" border="0" width="600" height="352" /></p>

<p><img style="display:block; margin-left:auto; margin-right:auto;" src="http://www.weixuhong.com/content/uploads/2011/10/Screen-Shot-2011-10-14-at-2.18.03-PM.png" alt="Screen Shot 2011-10-14 at 2.18.03 PM.png" border="0" width="417" height="590" /></p>

<p><img style="display:block; margin-left:auto; margin-right:auto;" src="http://www.weixuhong.com/content/uploads/2011/10/Screen-Shot-2011-10-14-at-3.31.51-PM.png" alt="Screen Shot 2011-10-14 at 3.31.51 PM.png" border="0" width="600" height="432" /></p>

<p><img style="display:block; margin-left:auto; margin-right:auto;" src="http://www.weixuhong.com/content/uploads/2011/10/Screen-Shot-2011-10-14-at-3.33.11-PM.png" alt="Screen Shot 2011-10-14 at 3.33.11 PM.png" border="0" width="600" height="380" /></p>

<p><img style="display:block; margin-left:auto; margin-right:auto;" src="http://www.weixuhong.com/content/uploads/2011/10/Screen-Shot-2011-10-17-at-5.20.27-PM.png" alt="Screen Shot 2011-10-17 at 5.20.27 PM.png" border="0" width="600" height="332" /></p>

<p><img style="display:block; margin-left:auto; margin-right:auto;" src="http://www.weixuhong.com/content/uploads/2011/10/Screen-Shot-2011-10-18-at-3.37.23-PM.png" alt="Screen Shot 2011-10-18 at 3.37.23 PM.png" border="0" width="600" height="378" /></p>

<p>转载请注明：<a href="http://www.weixuhong.com">韦旭红的点点滴滴</a> » <a href="http://www.weixuhong.com/archives/563">关于backbone _.bindAll</a></p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[APIdock in Textmate]]></title>
    <link href="http://weixuhong.com/archives/561"/>
    <updated>2011-10-08T00:00:00+08:00</updated>
    <id>http://weixuhong.com/archives/apidock-in-textmate</id>
    <content type="html"><![CDATA[<pre lang="c">% mkdir -p ~/Library/Application Support/Textmate/Bundles
% cd ~/Library/Application Support/Textmate/Bundles
% git clone git://github.com/lautis/ruby-on-rails-tmbundle.git "Ruby on Rails.tmbundle"
% git clone git://github.com/lautis/ruby-tmbundle.git "Ruby.tmbundle"
% osascript -e 'tell app "TextMate" to reload bundles'
</pre>

<p>转载请注明：<a href="http://www.weixuhong.com">韦旭红的点点滴滴</a> » <a href="http://www.weixuhong.com/archives/561">APIdock in Textmate</a></p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[安装passenger for Rails3]]></title>
    <link href="http://weixuhong.com/archives/557"/>
    <updated>2011-09-07T00:00:00+08:00</updated>
    <id>http://weixuhong.com/archives/%e5%ae%89%e8%a3%85passenger-for-rails3</id>
    <content type="html"><![CDATA[<pre lang="c">gem install passenger

</pre>

<pre lang="c">yum install apr-devel
yum install apr-util-devel
yum install httpd-devel
</pre>

<pre lang="c">passenger-install-apache2-module
</pre>

<p>复杂以下文件到httpd.conf</p>

<pre lang="c">LoadModule passenger_module /usr/local/rvm/gems/ruby-1.9.2-p290-module/gems/passenger-3.0.9/ext/apache2/mod_passenger.so
   PassengerRoot /usr/local/rvm/gems/ruby-1.9.2-p290-module/gems/passenger-3.0.9
   PassengerRuby /usr/local/rvm/wrappers/ruby-1.9.2-p290-module/ruby
</pre>

<pre lang="c">#For PAIFAN 后台
&lt;VirtualHost *:80&gt;
 ServerName padmin.qdigit.cn
 RailsEnv production
 #RailsEnv development 
 DocumentRoot /var/www/html/admin.insta/public
 ErrorLog /var/www/html/admin.insta/log/redmine.error.log
  &lt;Directory /var/www/html/admin.insta/public&gt;
  AllowOverride all
  #Options -MultiViews           
  Options Indexes -MultiViews
 &lt;/Directory&gt;
&lt;/VirtualHost&gt;

</pre>

<p>参考: http://www.modrails.com/install.html</p>

<p>转载请注明：<a href="http://www.weixuhong.com">韦旭红的点点滴滴</a> » <a href="http://www.weixuhong.com/archives/557">安装passenger for rails3</a></p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[如果使用ruby Gem Redis查看redis的keys]]></title>
    <link href="http://weixuhong.com/archives/553"/>
    <updated>2011-08-04T00:00:00+08:00</updated>
    <id>http://weixuhong.com/archives/%e5%a6%82%e6%9e%9c%e4%bd%bf%e7%94%a8ruby-gem-redis%e6%9f%a5%e7%9c%8bredis%e7%9a%84keys</id>
    <content type="html"><![CDATA[<pre lang="ruby">irb(main):002:0&gt; require 'rubygems'
=&gt; true
irb(main):003:0&gt; require 'redis'
=&gt; true
irb(main):004:0&gt; r = Redis.new
=&gt; #&lt;Redis:0x8605b64 @sock=#&lt;TCPSocket:0x8605ab0&gt;, @timeout=5, @port=6379, @db=0, @host="127.0.0.1"&gt;
irb(main):005:0&gt; r.keys('*')

列出某个的key的值：

r.sort("Listen:1")



</pre>

<p>转载请注明：<a href="http://www.weixuhong.com">韦旭红的点点滴滴</a> » <a href="http://www.weixuhong.com/archives/553">如果使用ruby gem redis查看redis的keys</a></p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Rails 3.1 Mountable Engines 使用方法]]></title>
    <link href="http://weixuhong.com/archives/551"/>
    <updated>2011-08-01T00:00:00+08:00</updated>
    <id>http://weixuhong.com/archives/rails-3-1-mountable-engines-%e4%bd%bf%e7%94%a8%e6%96%b9%e6%b3%95</id>
    <content type="html"><![CDATA[<p>在了解 Moutable之前， 先看这个视频：</p>

<p>http://railscasts.com/episodes/277-mountable-engines</p>

<p>了解Mountable Engines与Full Engines的区别， 看这篇文章:</p>

<p>http://stackoverflow.com/questions/6118905/rails-3-1-engine-vs-mountable-app</p>

<p>当我们使用：</p>

<pre lang="ruby">rails plugin new uhoh --mountable
</pre>

<p>我们可以把这个创建好的plugin变成一个gem来使用。</p>

<p>比如我们可以先创建一个rails app</p>

<pre lang="ruby">rails new with_engine -T -O -J
</pre>

<p>编辑Gemfile, 添加以下一行:</p>

<pre lang="ruby">gem 'uhoh', :path =&gt; '/Users/weston/Downloads/277-mountable-engines/uhoh-after/' #刚才创建的mountable 路径

</pre>

<p>执行</p>

<pre lang="ruby">bundle install 

vim config/routs.rb
</pre>

<p>添加以下一行:</p>

<pre lang="ruby">mount Uhoh::Engine =&gt; "/uhoh", :as =&gt; "uhoh_engine"
</pre>

<p>这样我们就可以使用这个engines了…</p>

<p>转载请注明：<a href="http://www.weixuhong.com">韦旭红的点点滴滴</a> » <a href="http://www.weixuhong.com/archives/551">rails 3.1 Mountable Engines 使用方法</a></p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[关于Rails使用Callback和Observer的区别]]></title>
    <link href="http://weixuhong.com/archives/547"/>
    <updated>2011-07-27T00:00:00+08:00</updated>
    <id>http://weixuhong.com/archives/%e5%85%b3%e4%ba%8erails%e4%bd%bf%e7%94%a8callback%e5%92%8cobserver%e7%9a%84%e5%8c%ba%e5%88%ab</id>
    <content type="html"><![CDATA[<p>可以参考：</p>

<p>http://stackoverflow.com/questions/1531514/observers-vs-callbacks</p>

<p>其中有一段是这样的：</p>

<pre lang="ruby">class Model &lt; ActiveRecord::Base
  before_update :disallow_bob

  def disallow_bob
  return false if model.name == "bob"
  end
end

class ModelObserver &lt; ActiveRecord::Observer
  def before_update(model)
    return false if model.name == "mary"
  end
end

m = Model.create(:name =&gt; "whatever")

m.update_attributes(:name =&gt; "bob")
=&gt; false -- name will still be "whatever" in database

m.update_attributes(:name =&gt; "mary")
=&gt; true -- name will be "mary" in database
</pre>

<p>Observers may only observe, they may not intervene.</p>

<p>转载请注明：<a href="http://www.weixuhong.com">韦旭红的点点滴滴</a> » <a href="http://www.weixuhong.com/archives/547">关于Rails使用Callback和Observer的区别</a></p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Rails 3, RSpec, Cucumber, jQuery, Devise, Mongoid, and Compass(转)]]></title>
    <link href="http://weixuhong.com/archives/545"/>
    <updated>2011-07-19T00:00:00+08:00</updated>
    <id>http://weixuhong.com/archives/rails-3-rspec-cucumber-jquery-devise-mongoid-and-compass%e8%bd%ac</id>
    <content type="html"><![CDATA[<p>来源:http://jimdrannbauer.com/2011/01/29/rails-3-rspec-cucumber-jquery-devise-mongoid-and-compass/</p>

<p>Want to build a Rails 3 app with this stuff?</p>

<p>Git<br />
RSpec<br />
Cucumber w/ Capybara<br />
Mongoid<br />
Devise<br />
CanCan<br />
jQuery<br />
Compass<br />
Blueprintcss<br />
Haml<br />
Sass<br />
Capistrano<br />
Passenger<br />
Factory Girl<br />
Shoulda<br />
metric_fu<br />
Here’s how.</p>

<p>Just A Checklist</p>

<p>This article is mostly written for myself so I don’t have to remember where I found all of the information. There’s nothing particularly difficult about anything here. I just like the idea of having it all in one place. I figured it might be helpful to others, so… uh… here it is.</p>

<p>Having said that, this is not a tutorial. I don’t explain how to do Behavior Driven Development, how to use CanCan, or why to use any of this stuff. It’s just a checklist… a detailed checklist. It would probably make a good Rails Template.</p>

<p>Prerequisites</p>

<p>The installation of MongoDB and Git are beyond the scope…</p>

<p>Initialize the app</p>

<p>In your shell:</p>

<pre lang="c">mkdir awesome-app
cd awesome-app
git init
rails new . -T -J -O
</pre>

<p>Create the empty directory first so that you can init an empty git repo. The -T option excludes the Test/Unit files so that we can use RSpec instead. The -J option excludes the prototype.js files so that we can use jQuery instead. The -O option excludes ActiveRecord (O is for ORM) so that we can use Mongoid instead.</p>

<p>Commit it:</p>

<pre lang="c">git add .
git commit -m "initial commit"
Bundle the Gems
</pre>

<p>Here’s the first place you need to modify files. In Gemfile:</p>

<pre lang="ruby">source 'http://rubygems.org'
gem 'rails',    '3.0.3'
gem 'mongoid',  '2.0.0.rc.6'
gem 'bson_ext', '~&gt; 1.2'
gem 'devise'
gem 'cancan'
gem 'jquery-rails'
gem 'passenger'
gem 'capistrano'
gem "compass", "&gt;= 0.10.6"
gem 'haml'
group :development, :test do
  gem 'capybara'
  gem 'cucumber'
  gem 'cucumber-rails'
  gem 'database_cleaner'
  gem 'rspec'
  gem 'rspec-rails'
  gem 'shoulda'
  gem 'factory_girl_rails'
  gem 'autotest'
  gem 'launchy'
  gem 'faker'
  gem 'ruby-debug19'
  gem 'haml-rails'
  gem 'metric_fu'
end

</pre>

<p>Then, back in your shell:</p>

<pre lang="c">bundle install
</pre>

<p>Commit it:</p>

<pre lang="c">git add .
git commit -m "Added Gems"
Mongoid
</pre>

<p>Mongoid is an ORM for MongoDB. I’ll assume you have it installed already. Dig it:</p>

<pre lang="c"># Ignore this message if you see it since you're
# running the command it's asking for right now:

# Mongoid config not found. Create a config file at: config/mongoid.yml
# to generate one run: rails generate mongoid:config
rails g mongoid:config

</pre>

<p>After running the mongoid generator, your app is configured to use Mongoid instead of ActiveRecord. When you generate a model, Rails will generate a Mongoid Document.</p>

<p>Let’s edit some files and get it set up.</p>

<p>In config/mongoid.yml:</p>

<pre lang="c">defaults: &#038;defaults
  host: localhost
  # mongoid defaults for configurable settings
  autocreate_indexes: false
  allow_dynamic_fields: true
  include_root_in_json: false
  parameterize_keys: true
  persist_in_safe_mode: false
  raise_not_found_error: true
  reconnect_time: 3
development:
  &lt;&lt;: *defaults
  database: awesome_app_development
test: &#038;TEST
  &lt;&lt;: *defaults
  database: awesome_app_test
cucumber:
  &lt;&lt;: *TEST
# set these environment variables on your prod server
production:
  host: &lt;%= ENV['MONGOID_HOST'] %&gt;
  port: &lt;%= ENV['MONGOID_PORT'] %&gt;
  username: &lt;%= ENV['MONGOID_USERNAME'] %&gt;
  password: &lt;%= ENV['MONGOID_PASSWORD'] %&gt;
  database: &lt;%= ENV['MONGOID_DATABASE'] %&gt;
</pre>

<p>There are 2 things to notice here. First, the configurable settings can be excluded. Even though Mongoid will default to the above options, leave them so that you don’t have to look at the documentation. Second, we added an environment for Cucumber which just points back to the test environment.</p>

<p>Commit it:</p>

<pre lang="c">git add .
git commit -m "Added Mongoid"
RSpec
</pre>

<p>Now, we use the rails generator to install RSpec. Shell:</p>

<pre lang="c">rails g rspec:install
Next, in spec/spec_helper.rb:

RSpec.configure do |config|
  config.mock_with :rspec

  require 'database_cleaner'

  config.before(:suite) do
    DatabaseCleaner.strategy = :truncation
    DatabaseCleaner.orm = "mongoid"
  end

  config.before(:each) do
    DatabaseCleaner.clean
  end
end
</pre>

<p>This is all you need in your RSpec configuration to use it with Mongoid. MongoDB doesn’t do transactions so we need to truncate the database between tests instead of rolling back. DatabaseCleaner helps with that.</p>

<p>Commit it:</p>

<pre lang="c">git add .
git commit -m "Added RSpec"
</pre>

<p>Cucumber</p>

<p>Next, we use the rails generator again to install Cucumber. Shell:</p>

<pre lang="c">rails g cucumber:install --capybara --rspec --skip-database
</pre>

<p>The –capybara option sets up Capybara instead of Webrat. The –rspec option enables RSpec matchers for your step definitions.</p>

<p>The Cucumber generator will bark at you about a missing database.yml file without the –skip-database option because we skipped the ORM when we created the app.</p>

<p>Like RSpec, some configuration is necessary to make Cucumber play nice with Mongoid. Add this file, features/support/database_cleaner.rb:</p>

<pre lang="c">require 'database_cleaner'
DatabaseCleaner.strategy = :truncation
DatabaseCleaner.orm = "mongoid"
Before { DatabaseCleaner.clean }
</pre>

<p>This does the same thing for Cucumber that it does for RSpec: truncates your data between scenarios.</p>

<p>Commit it:</p>

<pre lang="c">git add .
git commit -m "Added Cucumber"
</pre>

<p>Devise</p>

<p>Devise is used for authentication.</p>

<p>Shell it:</p>

<p>rails g devise:install<br />
Devise needs a few things in place so that it can provide it’s functionality and it’ll let you know it when the installation is done:</p>

<pre lang="c">===============================================================================

Some setup you must do manually if you haven't yet:

  1. Setup default url options for your specific environment. Here is an
     example of development environment:

       config.action_mailer.default_url_options = { :host =&gt; 'localhost:3000' }

     This is a required Rails configuration. In production it must be the
     actual host of your application

  2. Ensure you have defined root_url to *something* in your config/routes.rb.
     For example:

       root :to =&gt; "home#index"

  3. Ensure you have flash messages in app/views/layouts/application.html.erb.
     For example:

       <p class="notice">
  &lt;%= notice %&gt;
</p>
       

<p class="alert">
  &lt;%= alert %&gt;
</p>

===============================================================================
</pre>

<p>For now, all you need to do are steps 1 and 2 above. We’ll handle step 3 when we get into the Haml/Sass/Compass stuff later.</p>

<p>In config/environments/development.rb, add this:</p>

<pre lang="c">config.action_mailer.default_url_options = { :host =&gt; 'localhost:3000' }
</pre>

<p>In config/routes.rb, add this:</p>

<pre lang="c">root :to =&gt; "home#index"
<pre>

Finally, Devise needs a model to hold login credentials. Let’s call it User. In the shell:
<pre lang="c">

rails g mongoid:devise User
</pre>


<p>
  Take a look in app/models/user.rb. Notice that it generated a Mongoid Document.
</p>


<p>
  Finish up by adding this to routes.rb:
</p>


<pre lang="c">

devise_for :users
Commit it:

git add .
git commit -m "Added Devise"
</pre>


<p>
  CanCan
</p>


<p>
  CanCan does role-based user authorization.
</p>


<pre lang="c">

rails g cancan:ability
That’s it.
</pre>


<p>
  Commit it:
</p>


<pre lang="c">

git add .
git commit -m "Added CanCan"
</pre>


<p>
  jQuery
</p>


<p>
  We used the -J option when we created the app so that we could use jQuery instead of Prototype. In your shell, run the jQuery generator:
</p>


<pre lang="c">

rails g jquery:install --ui
</pre>


<p>
  This’ll do 3 main things: remove the existing protoypejs-based javascript files (which, in our case, aren’t there anyway), drop in the latest jQuery, and drop in the jQuery version of the Rails Unobtrusive Javascript (UJS) Adapter. Since jQueryUI is pretty cool too, we drop that in too with the –ui option.
</p>


<p>
  In order to make the :defaults argument to javascript_include_tag load the .js files in the right order, we need to modify config/application.rb. Look for:
</p>


<pre lang="c">

config.action_view.javascript_expansions[:defaults] = %w()
and change it to:

config.action_view.javascript_expansions[:defaults] =
  %w(jquery.min jquery-ui.min rails)
</pre>


<p>
  Notice that we load the minified versions which were downloaded by the generator.
</p>


<p>
  Commit it:
</p>


<pre lang="c">

git add .
git commit -m "Added jQuery"
Compass/Haml/Sass/Blueprintcss
</pre>


<p>
  Haml is a template langauge like erb. When we added “gem ‘haml’” to the Gemfile, we made Rails recognize that files with the .haml extension contain Haml markup. Sass is a superset of css3 that helps keep your stylesheets clean. Blueprintcss is a css framework that provides easy to use reset, grid, and typographical styles. Compass ties all this together and provides a way to integrate it into your app.
</p>


<p>
  Run this to install Compass into your app using Blueprintcss:
</p>


<pre lang="c">

compass init rails . --using blueprint/semantic
</pre>


<p>
  Compass will ask you a few questions. Just say yes to both of them.
</p>


<pre lang="c">

Compass recommends that you keep your stylesheets in app/stylesheets
  instead of the Sass default location of public/stylesheets/sass.
  Is this OK? (Y/n) Y

Compass recommends that you keep your compiled css in public/stylesheets/compiled/
  instead the Sass default of public/stylesheets/.
  However, if you're exclusively using Sass, then public/stylesheets/ is recommended.
  Emit compiled stylesheets to public/stylesheets/compiled/? (Y/n) Y

</pre>


<p>
  After that, it’ll drop a bunch of files into the app and finish up with some instructions. We’ve already done the first suggestion, added Compass to the Gemfile. The second suggestion gives us the opportunity to put together our layout.
</p>


<p>
  Create app/views/layout/application.html.haml and place this inside:
</p>


<pre lang="c">


!!! XML
!!!
%html
  %head
    %title Awesome App
    = javascript_include_tag :defaults
    = csrf_meta_tag
    = stylesheet_link_tag :all
    = stylesheet_link_tag 'compiled/screen.css', :media =&gt; 'screen, projection'
    = stylesheet_link_tag 'compiled/print.css',  :media =&gt; 'print'
    /[if lt IE 8]
      = stylesheet_link_tag 'compiled/ie.css', :media =&gt; 'screen, projection'

  %body.bp.two-col

    #container

      #header
        %h1 Awesome App Header

      #sidebar
        %div item 1
        %div item 2
        %div item 3
        %div item 4

      #content

        %p.notice= notice
        %p.error= alert
        %p.success= notice

        = yield

      #footer
        %h3 Awesome App Footer

</pre>


<p>
  There are a few things to notice in there. First, it’s Haml. Second, we’ve included the stylesheet info from the compass command output in the head. Third, we’re using the built-in Blueprintcss 2-column layout. Finally, we’ve added the notice and alert elements that Devise asked for earlier. There’s also a success element in there to show off some of the coloring that Blueprintcss gives you.
</p>


<p>
  If you try to look at it now, it won’t work. Sit tight, we’re close.
</p>


<p>
  Making Compass Just Work
</p>


<p>
  The Compass documentation seems to lack a simple explanation of how to see if things just work. Here it is:
</p>


<p>
  Create app/stylesheets/partials/_application.scss, and place this inside:
</p>


<pre lang="c">

#container {
  @include showgrid;
}
</pre>


<p>
  Use this file to get started adding your own styles. The showgrid mixin is useful for debugging your Blueprintcss grid. Delete it or comment it out when you’re done.
</p>


<p>
  Then, add this to app/stylesheets/screen.scss:
</p>


<p>
  // Add the application styles.<br />
  @import &#8220;partials/application&#8221;;<br />
  This makes sure that your own styles are available when you get around to adding them.
</p>


<p>
  Commit it:
</p>


<p>
  git add .<br />
  git commit -m &#8220;Added Compass&#8221;<br />
  Last Steps Before Starting the App
</p>


<p>
  Delete public/index.html:
</p>


<p>
  rm public/index.html<br />
  Earlier, Devise instructed us to setup the root route in routes.rb. The problem is the route we added won’t actually work until we have a home controller with an index action.
</p>


<p>
  Shell it:
</p>


<p>
  rails g controller home index<br />
  Notice that the views generated use Haml. That works because we added the ‘haml-rails’ gem to the Gemfile.
</p>


<p>
  Then, so that we can see Devise in action:
</p>


<p>
  rails g controller vip index<br />
  In app/controllers/vip_controller.rb, add:
</p>


<p>
  before_filter :authenticate_user!<br />
  Commit it:
</p>


<p>
  git add .<br />
  git commit -m &#8220;Added Home and Vip controllers and views&#8221;<br />
  Start It Up
</p>


<p>
  passenger start<br />
  Now go to: http://localhost:3000
</p>


<p>
  Nice! See the grid? Clean.
</p>


<p>
  How about this one? http://localhost:3000/vip/index
</p>


<p>
  Go ahead. Mess with the login stuff. It’ll just kinda work.
</p>


<p>
  One More Thing, metric_fu
</p>


<p>
  Add this to your Rakefile:
</p>


<p>
  require &#8216;metric_fu&#8217;<br />
  MetricFu::Configuration.run do |config|<br />
    config.rcov[:test_files] = [&#8216;spec/**/*_spec.rb&#8217;]<br />
    config.rcov[:rcov_opts] &lt;&lt; &#8220;-Ispec&#8221; # Needed to find spec_helper<br />
  end<br />
  Get your metrics by running this:
</p>


<p>
  rake metrics:all<br />
  Commit it:
</p>


<p>
  git add .<br />
  git commit -m &#8220;Added metric_fu&#8221;<br />
  Conclusion
</p>


<p>
  Okay, so it doesn’t really do anything… yet. That’s okay. You’re smart. Make.
</p>


<p>
  There were a few things in the list at the top that I didn’t go into more detail about (Capistrano, Passenger, Factory Girl, and Shoulda). That’s because they’re ready to go; inclusion in the Gemfile was enough. Just start using ‘em.
</p>


<p>
  Links
</p>


<p>
  Here’s a list of links to the documentation and articles I used to pull this together:
</p>


<p>
  http://relishapp.com/rspec/rspec-rails
</p>


<p>
  http://github.com/aslakhellesoy/cucumber-rails/blob/master/README.rdoc
</p>


<p>
  http://github.com/thoughtbot/shoulda
</p>


<p>
  http://github.com/thoughtbot/factory_girl_rails
</p>


<p>
  http://mongoid.org/docs/installation
</p>


<p>
  http://mongoid.org/docs/integration
</p>


<p>
  http://mongoid.org/docs/extensions
</p>


<p>
  http://github.com/plataformatec/devise
</p>


<p>
  https://github.com/ryanb/cancan
</p>


<p>
  http://www.tonyamoyal.com/2010/07/28/rails-authentication-with-devise-and-cancan-customizing-devise-controllers/
</p>


<p>
  https://github.com/indirect/jquery-rails
</p>


<p>
  http://haml-lang.com/
</p>


<p>
  http://sass-lang.com/
</p>


<p>
  http://compass-style.org/
</p>


<p>
  http://blueprintcss.org/
</p>


<p>
  https://github.com/joshuaclayton/blueprint-css/wiki
</p>


<p>
  转载请注明：<a href="http://www.weixuhong.com">韦旭红的点点滴滴</a> &raquo; <a href="http://www.weixuhong.com/archives/545">Rails 3, RSpec, Cucumber, jQuery, Devise, Mongoid, and Compass(转)</a>
</p>
</pre></pre>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[常用gem]]></title>
    <link href="http://weixuhong.com/archives/537"/>
    <updated>2011-07-18T00:00:00+08:00</updated>
    <id>http://weixuhong.com/archives/%e5%b8%b8%e7%94%a8gem</id>
    <content type="html"><![CDATA[<pre lang="ruby">source 'http://rubygems.org'

# --------------------
#   Rails
# --------------------
# gem 'rails',                     '~&gt; 3.0.0'
gem 'rails',                     :git =&gt; 'git://github.com/rails/rails.git', :branch =&gt; '3-0-stable'
# gem 'rails',                     :path =&gt; '/Users/fred/Downloads/Repos/Rails/rails-master'

# --------------------
#   Database
# --------------------
gem 'mysql2',                    :git =&gt; 'git://github.com/brianmario/mysql2.git'
gem 'datamappify',               '&gt;= 0.2.1'
gem 'by_star',                   '~&gt; 0.9.0'
# gem 'slim_scrooge',              '~&gt; 1.0.10', :group =&gt; :production
# gem 'meta_where',                '&gt;= 0.9.3'

# --------------------
#   Resources
# --------------------
gem 'inherited_resources',       '~&gt; 1.1.2'
gem 'inherited_resources_views'
gem 'devise',                    '~&gt; 1.1.2'
gem 'cancan',                    '~&gt; 1.3.0'
gem 'carrierwave',               '~&gt; 0.5.0'

# --------------------
#   Presentation
# --------------------
gem 'haml',                      '~&gt; 3.0.18'
gem 'compass'
gem 'simple_form',               '~&gt; 1.2.0'
gem 'simple-navigation',         '~&gt; 2.7.0'
gem 'will_paginate',             '~&gt; 3.0.pre'

# --------------------
#   Assets
# --------------------
gem 'rails_config'
gem 'rdiscount',                 '&gt;= 1.6.5'
gem 'sanitize'
gem 'rubyzip',                   :require =&gt; 'zip/zip'
gem 'csv-mapper',                '&gt;= 0.5.0'
gem 'ffaker',                    '&gt;= 0.4.0'

# --------------------
#   Server/Deployment
# --------------------
gem 'dalli'
gem 'thin'
gem 'capistrano-ext'
gem 'deployer',                  :git =&gt; 'git://github.com/meskyanichi/deployer.git'
gem 'hoptoad_notifier'
gem 'newrelic_rpm'

group :development do
  gem 'bullet',                  '~&gt; 2.0.0.rc1'
  gem 'hpricot',                 '&gt;= 0.8.2'
  gem 'ruby_parser',             '&gt;= 2.0.4'
end

group :development, :test do
  gem 'rspec-rails',             '~&gt; 2.0.0.beta.22'
  gem 'steak',                   :git =&gt; 'git://github.com/cavalle/steak.git'
  gem 'capybara',                :git =&gt; 'git://github.com/jnicklas/capybara.git'
  gem 'delorean'
  gem 'database_cleaner'
  gem 'launchy'
  gem 'parallel_tests',          :git =&gt; 'git://github.com/grosser/parallel_tests.git'
  # gem 'parallel_tests',          :path =&gt; '/Users/fred/Downloads/Repos/Rails/fredwu-parallel_tests'
end
</pre>

<p>也可以参考：http://thoughtrails.com/episodes/24-popular-and-useful-plugins-for-rails3</p>

<p>转载请注明：<a href="http://www.weixuhong.com">韦旭红的点点滴滴</a> » <a href="http://www.weixuhong.com/archives/537">常用gem</a></p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[小组级git服务器搭建（转)]]></title>
    <link href="http://weixuhong.com/archives/541"/>
    <updated>2011-07-18T00:00:00+08:00</updated>
    <id>http://weixuhong.com/archives/%e5%b0%8f%e7%bb%84%e7%ba%a7git%e6%9c%8d%e5%8a%a1%e5%99%a8%e6%90%ad%e5%bb%ba%ef%bc%88%e8%bd%ac</id>
    <content type="html"><![CDATA[<p>来自：http://blog.prosight.me/index.php/2009/11/485</p>

<p>如果使用git的人数较少，可以使用下面的步骤快速部署一个git服务器环境。<br />
1. 生成 SSH 公钥<br />
每个需要使用git服务器的工程师，自己需要生成一个ssh公钥<br />
进入自己的~/.ssh目录，看有没有用 文件名 和 文件名.pub 来命名的一对文件，这个 文件名 通常是 id_dsa 或者 id_rsa。 .pub 文件是公钥，另一个文件是密钥。假如没有这些文件（或者干脆连 .ssh 目录都没有），你可以用 ssh-keygen 的程序来建立它们，该程序在 Linux/Mac 系统由 SSH 包提供， 在 Windows 上则包含在 MSysGit 包里:</p>

<pre lang="c">$ ssh-keygen 
Generating public/private rsa key pair.
Enter file in which to save the key (/Users/schacon/.ssh/id_rsa): 
Enter passphrase (empty for no passphrase): 
Enter same passphrase again: 
Your identification has been saved in /Users/schacon/.ssh/id_rsa.
Your public key has been saved in /Users/schacon/.ssh/id_rsa.pub.
The key fingerprint is:
43:c5:5b:5f:b1:f1:50:43:ad:20:a6:92:6a:1f:9a:3a schacon@agadorlaptop.local
</pre>

<p>它先要求你确认保存公钥的位置（.ssh/id_rsa），然后它会让你重复一个密码两次，如果不想在使用公钥的时候输入密码，可以留空。<br />
现在，所有做过这一步的用户都得把它们的公钥给你或者 Git 服务器的管理者（假设 SSH 服务被设定为使用公钥机制）。他们只需要复制 .pub 文件的内容然后 e-</p>

<pre lang="c">$ cat ~/.ssh/id_rsa.pub 
ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEAklOUpkDHrfHY17SbrmTIpNLTGK9Tjom/BWDSU
GPl+nafzlHDTYW7hdI4yZ5ew18JH4JW9jbhUFrviQzM7xlELEVf4h9lFX5QVkbPppSwg0cda3
Pbv7kOdJ/MTyBlWXFCR+HAo3FXRitBqxiX1nKhXpHAZsMciLq8V6RjsNAQwdsdMFvSlVK/7XA
t3FaoJoAsncM1Q9x5+3V0Ww68/eIFmb1zuUFljQJKprrX88XypNDvjYNby6vw/Pb0rwert/En
mZ+AW4OZPnTPI89ZPmVMLuayrD2cE86Z/il8b+gw3r3+1nKatmIkjn2so1d01QraTlMqVSsbx
NrRFi9wrf+M7Q== schacon@agadorlaptop.local
</pre>

<ol>
  <li>架设服务器<br />
首先，创建一个 ‘git’ 用户并为其创建一个 .ssh 目录，在用户主目录下:</li>
</ol>

<pre lang="c">$ sudo adduser git
$ su git
$ cd
$ mkdir .ssh
</pre>

<p>接下来，把开发者的 SSH 公钥添加到这个用户的 authorized_keys 文件中。假设你通过 e-mail 收到了几个公钥并存到了临时文件里。只要把它们加入 authorized_keys 文件</p>

<pre lang="c">$ cat /tmp/id_rsa.john.pub &gt;&gt; ~/.ssh/authorized_keys
$ cat /tmp/id_rsa.josie.pub &gt;&gt; ~/.ssh/authorized_keys
$ cat /tmp/id_rsa.jessica.pub &gt;&gt; ~/.ssh/authorized_keys
</pre>

<p>现在可以使用 –bare 选项运行 git init 来设定一个空仓库，这会初始化一个不包含工作目录的仓库。</p>

<pre lang="c">$ cd /opt/git
$ mkdir project.git
$ cd project.git
$ git --bare init
</pre>

<p>这时，开发人员就可以把它加为远程仓库，推送一个分支，从而把第一个版本的工程上传到仓库里了。值得注意的是，每次添加一个新项目都需要通过 shell 登入主机并创建一个纯仓库。我们不妨以 gitserver 作为 git 用户和仓库所在的主机名。如果你在网络内部运行该主机，并且在 DNS 中设定 gitserver 指向该主机，那么以下这些命令都是可用的：</p>

<p># 在一个工程师的电脑上</p>

<pre lang="c">$ cd myproject
$ git init
$ git add .
$ git commit -m 'initial commit'
$ git remote add origin git@gitserver:/opt/git/project.git
$ git push origin master
</pre>

<p>这样，其他人的克隆和推送也一样变得很简单：</p>

<pre lang="c">$ git clone git@gitserver:/opt/git/project.git
$ vim README
$ git commit -am 'fix for the README file'
$ git push origin master
</pre>

<p>用这个方法可以很快捷的为少数几个开发者架设一个可读写的 Git 服务。<br />
作为一个额外的防范措施，你可以用 Git 自带的 git-shell 简单工具来把 git 用户的活动限制在仅与 Git 相关。把它设为 git 用户登入的 shell，那么该用户就不能拥有主机正常的 shell 访问权。为了实现这一点，需要指明用户的登入shell 是 git-shell ，而不是 bash 或者 csh。你可能得编辑 /etc/passwd 文件</p>

<pre lang="c">$ sudo vim /etc/passwd
</pre>

<p>在文件末尾，你应该能找到类似这样的行：</p>

<pre lang="c">git:x:1000:1000::/home/git:/bin/sh
</pre>

<p>把 bin/sh 改为 /usr/bin/git-shell （或者用 which git-shell 查看它的位置）。该行修改后的样子如下：</p>

<p>git:x:1000:1000::/home/git:/usr/bin/git-shell<br />
现在 git 用户只能用 SSH 连接来推送和获取 Git 仓库，而不能直接使用主机 shell。尝试登录的话，你会看到下面这样的拒绝信息：</p>

<pre lang="c">$ ssh git@gitserver
</pre>

<p>fatal: What do you think I am? A shell? （你以为我是个啥？shell吗？)<br />
Connection to gitserver closed. （gitserver 连接已断开。）</p>

<p>转载请注明：<a href="http://www.weixuhong.com">韦旭红的点点滴滴</a> » <a href="http://www.weixuhong.com/archives/541">小组级git服务器搭建（转)</a></p>

]]></content>
  </entry>
  
</feed>
