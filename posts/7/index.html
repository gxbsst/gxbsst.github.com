
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>韦旭红的幸福时光</title>
  <meta name="author" content="Weston Wei(韦旭红)">

  
  <meta name="description" content="2.5 A Sea of Schemes In this section, we&#8217;ll take a look at the more common scheme formats on the Web. Appendix A gives a fairly exhaustive list &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://weixuhong.com/posts/7">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="韦旭红的幸福时光" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css" media="screen" />
<script type="text/javascript" src="/fancybox/jquery.fancybox.pack.js"></script>

<script language="Javascript" type="text/javascript">
$(document).ready(
  function() {
    (function($) {
      $(".fancybox[data-content-id]").each(function() {
        this.href = $(this).data('content-id');
      });
      $(".fancybox").fancybox({
        beforeLoad: function() {
          var el, 
              id = $(this.element).data('title-id');

          if (id) {
            el = $('#' + id);

            if (el.length) {
              this.title = el.html();
            }
          }
          if ($(this).data('content')) {
            this.content = $(this).data('content');
          }
        },
        helpers: {
          title: {
            type: 'inside'
          }
        }
      });
    })(jQuery);
  }
);
</script> 
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">韦旭红的幸福时光</a></h1>
  
    <h2>20，30，40&#8230;</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:weixuhong.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/photos">Photos</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/archives/273">A Sea of Schemes</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2009-09-05T00:00:00+08:00'><span class='date'><span class='date-month'>Sep</span> <span class='date-day'>5</span><span class='date-suffix'>th</span>, <span class='date-year'>2009</span></span> <span class='time'>12:00 am</span></time>
        
           | <a href="/archives/273#disqus_thread"
             data-disqus-identifier="http://weixuhong.com/archives/273">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>2.5 A Sea of Schemes</p>

<p>In this section, we&#8217;ll take a look at the more common scheme formats on the Web. Appendix A gives a fairly exhaustive list of schemes and references to their individual documentation.</p>

<p>Table 2-4 summarizes some of the most popular schemes. Reviewing Section 2.2 will make the syntax portion of the table a little more familiar.</p>

<p>Table 2-4. Common scheme formats</p>

<p>Scheme</p>

<p>Description</p>

<p>http</p>

<p>The Hypertext Transfer Protocol scheme conforms to the general URL format, except that there is no username or password. The port defaults to 80 if omitted.</p>

<p>Basic form:</p>

<p><a href="http://">http://</a><host>:<port>/<path>?<query>#<frag></p>

<p>Examples:</p>

<p><a href="http://www.joes-hardware.com/index.html">http://www.joes-hardware.com/index.html</a></p>

<p><a href="http://www.joes-hardware.com:80/index.html">http://www.joes-hardware.com:80/index.html</a></p>

<p>https</p>

<p>The https scheme is a twin to the http scheme. The only difference is that the https scheme uses Netscape&#8217;s Secure Sockets Layer (SSL), which provides end-to-end encryption of HTTP connections. Its syntax is identical to that of HTTP, with a default port of 443.</p>

<p>Basic form:</p>

<p><a href="https://">https://</a><host>:<port>/<path>?<query>#<frag></p>

<p>Example:</p>

<p><a href="https://www.joes-hardware.com/secure.html">https://www.joes-hardware.com/secure.html</a></p>

<p>mailto</p>

<p>Mailto URLs refer to email addresses. Because email behaves differently from other schemes (it does not refer to objects that can be accessed directly), the format of a mailto URL differs from that of the standard URL. The syntax for Internet email addresses is documented in Internet RFC 822.</p>

<p>Basic form:</p>

<p>mailto:<RFC-822-addr-spec></p>

<p>Example:</p>

<p><a href="&#109;&#97;&#105;&#108;&#116;&#x6f;&#58;&#106;&#111;&#x65;&#64;&#106;&#111;&#x65;&#115;&#45;&#104;&#x61;&#x72;&#x64;&#119;&#97;&#x72;&#101;&#x2e;&#99;&#111;&#x6d;">&#106;&#111;&#101;&#64;&#106;&#111;&#101;&#x73;&#x2d;&#104;&#x61;&#x72;&#x64;&#x77;&#x61;&#x72;&#x65;&#x2e;&#x63;&#x6f;&#x6d;</a></p>

<p>ftp</p>

<p>File Transfer Protocol URLs can be used to download and upload files on an FTP server and to obtain listings of the contents of a directory structure on an FTP server.</p>

<p>FTP has been around since before the advent of the Web and URLs. Web applications have assimilated FTP as a data-access scheme. The URL syntax follows the general form.</p>

<p>Basic form:</p>

<p><a href="ftp://">ftp://</a><user>:<password>@<host>:<port>/<path>;<params></p>

<p>Example:</p>

<p><a href="ftp://anonymous:joe%40joes-hardware.com@prep.ai.mit.edu:21/pub/gnu/">ftp://anonymous:joe%40joes-hardware.com@prep.ai.mit.edu:21/pub/gnu/</a></p>

<p>rtsp, rtspu</p>

<p>RTSP URLs are identifiers for audio and video media resources that can be retrieved through the Real Time Streaming Protocol.</p>

<p>The &#8220;u&#8221; in the rtspu scheme denotes that the UDP protocol is used to retrieve the resource.</p>

<p>Basic forms:</p>

<p>rtsp://<user>:<password>@<host>:<port>/<path></p>

<p>rtspu://<user>:<password>@<host>:<port>/<path></p>

<p>Example:</p>

<p>rtsp://www.joes-hardware.com:554/interview/cto_video</p>

<p>file</p>

<p>The file scheme denotes files directly accessible on a given host machine (by local disk, a network filesystem, or some other file-sharing system). The fields follow the general form. If the host is omitted, it defaults to the local host from which the URL is being used.</p>

<p>Basic form:</p>

<p>file://<host>/<path></p>

<p>Example:</p>

<p>file://OFFICE-FS/policies/casual-fridays.doc</p>

<p>news</p>

<p>The news scheme is used to access specific articles or newsgroups, as defined by RFC 1036. It has the unusual property that a news URL in itself does not contain sufficient information to locate the resource.</p>

<p>The news URL is missing information about where to acquire the resource—no hostname or machine name is supplied. It is the interpreting application&#8217;s job to acquire this information from the user. For example, in your Netscape browser, under the Options menu, you can specify your NNTP (news) server. This tells your browser what server to use when it has a news URL.</p>

<p>News resources can be accessed from multiple servers. They are said to be location-independent, as they are not dependent on any one source for access.</p>

<p>The &#8220;@&#8221; character is reserved within a news URL and is used to distinguish between news URLs that refer to newsgroups and news URLs that refer to specific news articles.</p>

<p>Basic forms:</p>

<p><a href="news:">news:</a><newsgroup></p>

<p><a href="news:">news:</a><news-article-id></p>

<p>Example:</p>

<p><a href="news:rec.arts.startrek">news:rec.arts.startrek</a></p>

<p>telnet</p>

<p>The telnet scheme is used to access interactive services. It does not represent an object per se, but an interactive application (resource) accessible via the telnet protocol.</p>

<p>Basic form:</p>

<p>telnet://<user>:<password>@<host>:<port>/</p>

<p>Example:</p>

<p>telnet://slurp:webhound@joes-hardware.com:23/</p>

<p>转载请注明：<a href="http://www.weixuhong.com">韦旭红的点点滴滴</a> &raquo; <a href="http://www.weixuhong.com/archives/273">A Sea of Schemes</a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/archives/269">Nginx结构图</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2009-09-03T00:00:00+08:00'><span class='date'><span class='date-month'>Sep</span> <span class='date-day'>3</span><span class='date-suffix'>rd</span>, <span class='date-year'>2009</span></span> <span class='time'>12:00 am</span></time>
        
           | <a href="/archives/269#disqus_thread"
             data-disqus-identifier="http://weixuhong.com/archives/269">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p><a href="http://www.weixuhong.com/content/uploads/2009/09/nginxmap-1.jpg" onclick="window.open('http://www.weixuhong.com/content/uploads/2009/09/nginxmap-1.jpg','popup','width=1385,height=2458,scrollbars=no,resizable=yes,toolbar=no,directories=no,location=no,menubar=no,status=yes,left=0,top=0');return false"><img src="http://www.weixuhong.com/content/uploads/2009/09/nginxmap-1-tm.jpg" height="400" width="225" border="1" hspace="4" vspace="4" alt="Nginxmap-1" /></a></p>

<p>转载请注明：<a href="http://www.weixuhong.com">韦旭红的点点滴滴</a> &raquo; <a href="http://www.weixuhong.com/archives/269">Nginx结构图</a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/archives/261">SVN 自动发布（SVN Auto Commit)</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2009-09-02T00:00:00+08:00'><span class='date'><span class='date-month'>Sep</span> <span class='date-day'>2</span><span class='date-suffix'>nd</span>, <span class='date-year'>2009</span></span> <span class='time'>12:00 am</span></time>
        
           | <a href="/archives/261#disqus_thread"
             data-disqus-identifier="http://weixuhong.com/archives/261">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><div class="wp_syntax">
  <div class="code">
    <pre class="bash">
#!/bin/bash
# Run commit every second.
# Why? Cron can't do that.

# Example:
# ./commit [svn url] [local svn path]

while [ true ]; do
data=`date`
message="*Auto-message*"
stat=`svn status $2`
if [[ $stat != '' ]]; then
delete_files=`svn status $2 |grep -e "^!"|cut -d" " -f7`
if [[ $delete_files != '' ]]; then
svn delete `svn status $2 |grep -e "^!"|cut -d" " -f7`>/dev/null 2>/dev/null # Add new files if there are any
svn commit --non-interactive -m "$message (delete)" $2 >/dev/null 2>>commit_log # Finaly commit
echo $delete_files $data
fi
add_files=`svn status $2 |grep -e "^?"|cut -d" " -f7`
if [[ $add_files != '' ]]; then
svn add $add_files >/dev/null 2>/dev/null # Add new files if there are any
svn commit --non-interactive -m "$message (add)" $2 >/dev/null 2>>commit_log # Finaly commit
echo $delete_files $data
fi
svn checkout $1 $2 >/dev/null 2>>/dev/null # Checkout
svn commit --non-interactive -m $message $2 >/dev/null 2>>commit_log # Finaly commit
echo $stat $data
fi
sleep 1
done
</pre>
  </div>
</div>


<ul>
<li>将以上脚本放在要自动发布的目录下</li>
<li>配置ctrontab让其自动发布</li>
</ul>


<p>转载请注明：<a href="http://www.weixuhong.com">韦旭红的点点滴滴</a> &raquo; <a href="http://www.weixuhong.com/archives/261">SVN 自动发布（SVN Auto Commit)</a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/archives/266">面试题目</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2009-09-02T00:00:00+08:00'><span class='date'><span class='date-month'>Sep</span> <span class='date-day'>2</span><span class='date-suffix'>nd</span>, <span class='date-year'>2009</span></span> <span class='time'>12:00 am</span></time>
        
           | <a href="/archives/266#disqus_thread"
             data-disqus-identifier="http://weixuhong.com/archives/266">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>面试题目的备份</p>

<p><a href="http://www.weixuhong.com/content/uploads/2009/09/interview.tar.gz">interview.tar.gz</a></p>

<p>转载请注明：<a href="http://www.weixuhong.com">韦旭红的点点滴滴</a> &raquo; <a href="http://www.weixuhong.com/archives/266">面试题目</a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/archives/260">Configure</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2009-08-18T00:00:00+08:00'><span class='date'><span class='date-month'>Aug</span> <span class='date-day'>18</span><span class='date-suffix'>th</span>, <span class='date-year'>2009</span></span> <span class='time'>12:00 am</span></time>
        
           | <a href="/archives/260#disqus_thread"
             data-disqus-identifier="http://weixuhong.com/archives/260">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>在RedHat AS4 安装<a href="http://blog.s135.com/nginx_php_v5/%E9%81%87%E5%88%B0%E7%9A%84%E4%B8%80%E4%B8%AAlibpng%E7%9A%84%E9%97%AE%E9%A2%98">http://blog.s135.com/nginx_php_v5/%E9%81%87%E5%88%B0%E7%9A%84%E4%B8%80%E4%B8%AAlibpng%E7%9A%84%E9%97%AE%E9%A2%98</a></p>

<p>下载了其中的rpm，安装但是编译php的时候老是遇到configure: error: png.h not found.的问题</p>

<p>我到/usr/src/redhat/SOURCES/找到<br/>
libpng-1.2.7.tar.bz2</p>

<ol>
<li><p>tar jxvf libpng-1.2.7.tar.bz2</p></li>
<li><p>cp scripts/makefile.std makefile</p></li>
<li><p>make</p></li>
<li><p>make install</p></li>
</ol>


<p>这个问题才解决</p>

<p>不知道rpm安装为什么不成功&#8230;</p>

<p>转载请注明：<a href="http://www.weixuhong.com">韦旭红的点点滴滴</a> &raquo; <a href="http://www.weixuhong.com/archives/260">configure</a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/archives/259">如果将C源文件(.c)生成目标文件(.o)</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2009-08-05T00:00:00+08:00'><span class='date'><span class='date-month'>Aug</span> <span class='date-day'>5</span><span class='date-suffix'>th</span>, <span class='date-year'>2009</span></span> <span class='time'>12:00 am</span></time>
        
           | <a href="/archives/259#disqus_thread"
             data-disqus-identifier="http://weixuhong.com/archives/259">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><pre>cc -c -o source.c target.o 
或者可以把其做成lib 
gcc -g -c source.c 
ar -rc libsource.a source.o 
 
</pre>


<p>转载请注明：<a href="http://www.weixuhong.com">韦旭红的点点滴滴</a> &raquo; <a href="http://www.weixuhong.com/archives/259">如果将C源文件(.c)生成目标文件(.o)</a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/archives/258">删除所有.svn目录</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2009-07-20T00:00:00+08:00'><span class='date'><span class='date-month'>Jul</span> <span class='date-day'>20</span><span class='date-suffix'>th</span>, <span class='date-year'>2009</span></span> <span class='time'>12:00 am</span></time>
        
           | <a href="/archives/258#disqus_thread"
             data-disqus-identifier="http://weixuhong.com/archives/258">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>当使用了svn版本控制系统后每个目录下都会有一个.svn目录存在，开发完当交付产品或者上传到服务器时一般要把这些目录删除，这里总结了一下在linux和win下的办法。</p>

<p>一、在linux下</p>

<p>删除这些目录是很简单的，命令如下</p>

<p>find . -type d -name &#8220;.svn&#8221;|xargs rm -rf</p>

<p>或者</p>

<p>find . -type d -iname &#8220;.svn&#8221; -exec rm -rf {} ;</p>

<p>全部搞定。(<a href="http://tech.techweb.com.cn/redirect.php?fid=26&amp;tid=205673&amp;goto=nextnewset">http://tech.techweb.com.cn/redirect.php?fid=26&amp;tid=205673&amp;goto=nextnewset</a>)</p>

<p>二、在windows下用以下法子：</p>

<p>1、在项目平级的目录，执行dos命令：<br/>
xcopy project_dir project_dir_1 /s /i</p>

<p>2、或者在项目根目录执行以下dos命令<br/>
for /r . %%a in (.) do @if exist &#8220;%%a.svn&#8221; rd /s /q &#8220;%%a.svn&#8221;<br/>
其实第二种方法可以用来干很多事的，比如把代码中的.svn替换为任意其他文件名并在硬盘根目录下执行，就可以从硬盘上删除所有的这个文件啦。</p>

<p>3、加注册表</p>

<p>Jon Galloway提供了一段注册表代码，可以将”Delete SVN Folders”命名增加到资源管理器的右键上，这样，鼠标点两下就能把选中目录下的所有.svn目录干掉了。Works just great!</p>

<p>代码为：</p>

<p>Windows Registry Editor Version 5.00</p>

<p>[HKEY_LOCAL_MACHINESOFTWAREClassesFoldershellDeleteSVN]@=”Delete SVN Folders“</p>

<p>[HKEY_LOCAL_MACHINESOFTWAREClassesFoldershellDeleteSVNcommand]@=”cmd.exe /c ”TITLE Removing SVN Folders in %1 &amp;&amp; COLOR 9A &amp;&amp; FOR /r ”%1” %%f IN (.svn) DO RD /s /q ”%%f” ”“<br/>
将这段代码保存为一个.reg文件，双击确认导入注册表即可。</p>

<p>转载请注明：<a href="http://www.weixuhong.com">韦旭红的点点滴滴</a> &raquo; <a href="http://www.weixuhong.com/archives/258">删除所有.svn目录</a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/archives/256">Yii不同Model使用不同的数据库(Multiple Database)</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2009-05-10T00:00:00+08:00'><span class='date'><span class='date-month'>May</span> <span class='date-day'>10</span><span class='date-suffix'>th</span>, <span class='date-year'>2009</span></span> <span class='time'>12:00 am</span></time>
        
           | <a href="/archives/256#disqus_thread"
             data-disqus-identifier="http://weixuhong.com/archives/256">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>在Yii如果其中有一个Model需要链接到不同的数据库，我可以重写getDbConnection这个方法：<br/>
比如我在Product这个model里面这样设置:</p>

<pre lang="php">public function getDbConnection()
  {
    $db = new CDbConnection('mysql:host=localhost;dbname=store', 'root', '');
    $db->active = true;
    return $db;
  }
</pre>


<p>但是如果要在behavior里面实现呢？那我们可以试一试!<br/>
经过在Behavior添加，没有发现成功，是不是有其他的方法呢？期待&#8230;</p>

<p>转载请注明：<a href="http://www.weixuhong.com">韦旭红的点点滴滴</a> &raquo; <a href="http://www.weixuhong.com/archives/256">Yii不同Model使用不同的数据库(Multiple Database)</a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/archives/257">在Yii使用Mixin &#8211; Behavior</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2009-05-10T00:00:00+08:00'><span class='date'><span class='date-month'>May</span> <span class='date-day'>10</span><span class='date-suffix'>th</span>, <span class='date-year'>2009</span></span> <span class='time'>12:00 am</span></time>
        
           | <a href="/archives/257#disqus_thread"
             data-disqus-identifier="http://weixuhong.com/archives/257">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>我们知道Ruby有Mixin的功能，可以扩展类的实例方法或者类方法，只需要include就可以做这样的事情，但是PHP好像没有这样好用的方法？但是在Yii有这样的方法，怎么实现呢？</p>

<p>下面有一个例子:</p>

<pre lang="php">Yii::app()->fileCache->attachBehavior('EFileCacheBehavior', array('class'=>'EFileCacheBehavior'));

</pre>


<p>如果要在App启动的时候就能永这个EFileCacheBehavior,可以在Main.php配置这个文件&#8230;</p>

<pre lang="php">'fileCache'=>array(
            'class'=>'application.extensions.filecache.EFileCache',
            'autoCleanExpiredCache'=>false,
            'behaviors'=>array(
                'EFileCacheBehavior'=>array(
                    'class'=>'EFileCacheBehavior',
                ),
            ),
        ), 
</pre>


<p>这样就可以扩展的方法了。<br/>
就是说如果EFileCacheBehavior有一个方法叫test();<br/>
那么你就可以通过：<br/>
Yii::app()->fileCache->test()调用。</p>

<p>转载请注明：<a href="http://www.weixuhong.com">韦旭红的点点滴滴</a> &raquo; <a href="http://www.weixuhong.com/archives/257">在Yii使用Mixin &#8211; Behavior</a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/archives/255">关于Yii的beforeAction，afterAction的用法</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2009-05-08T00:00:00+08:00'><span class='date'><span class='date-month'>May</span> <span class='date-day'>8</span><span class='date-suffix'>th</span>, <span class='date-year'>2009</span></span> <span class='time'>12:00 am</span></time>
        
           | <a href="/archives/255#disqus_thread"
             data-disqus-identifier="http://weixuhong.com/archives/255">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>有一个业务逻辑是这样: 如果订单已经成功，我则需要清空购物车，如果购物车为空，那么则不能执行几个Actions，如: checkout, confirm等, 我想框架应该都有beforeAction，一查API，真的可以找到，也看到YII的框架的CController源代码有这么一段:</p>

<pre lang="php">* Runs the action after passing through all filters.
   * This method is invoked by {@link runActionWithFilters} after all possible filters have been executed
   * and the action starts to run.
   * @param CAction action to run
   */
  public function runAction($action)
  {
    $priorAction=$this->_action;
    $this->_action=$action;
    if($this->beforeAction($action))
    {
      $action->run();
      $this->afterAction($action);
    }
    $this->_action=$priorAction;
  }
</pre>


<p>从这里可以看出，YII在每执行一个阿城题噢你都要经过beforeAction，$action, afterAction, 那么我可以Overwrite这两个方法达到我想要的效果:</p>

<pre lang="php">#如果购物成功，则要清空购物车的东西.
  protected  function afterAction( $action ){
    if ($action->getId() == 'success') {
      Yii::app()->session->remove('cart');
      Yii::app()->session->remove('order');
    }
  }

  #如购物车没有东西，则不能执行除buy以外的操作
  protected  function beforeAction( $action ){
    $action = $action->getId();
    if ( $action != 'buy') {
      $this->redirect(Yii::app()->homeUrl);
    }
  }

</pre>


<ul>
<li>从这里看出，有点filter的意思!</li>
</ul>


<p>&#8211;EOF&#8211;</p>

<p>转载请注明：<a href="http://www.weixuhong.com">韦旭红的点点滴滴</a> &raquo; <a href="http://www.weixuhong.com/archives/255">关于Yii的beforeAction，afterAction的用法</a></p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/posts/8">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/posts/6">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>About Me</h1>
  <p>一个写了多年代码的Ruby程序员，也即将是两个孩子他爸爸， 平时也热爱烘培，下厨房^_^</p>
</section><section>
  <h1>Categories</h1>
  <ul id="categories">
    <li class='category'><a href='/blog/categories/angularjs/'>angularjs (2)</a></li>
<li class='category'><a href='/blog/categories/directive/'>directive (1)</a></li>
<li class='category'><a href='/blog/categories/ide/'>ide (1)</a></li>
<li class='category'><a href='/blog/categories/ios/'>ios (6)</a></li>
<li class='category'><a href='/blog/categories/javascript/'>javascript (8)</a></li>
<li class='category'><a href='/blog/categories/linux-unix/'>linux/unix (24)</a></li>
<li class='category'><a href='/blog/categories/php/'>php (28)</a></li>
<li class='category'><a href='/blog/categories/rails/'>rails (1)</a></li>
<li class='category'><a href='/blog/categories/regular-expressions/'>regular expressions (2)</a></li>
<li class='category'><a href='/blog/categories/rspec/'>rspec (1)</a></li>
<li class='category'><a href='/blog/categories/ruby-ruby-on-rails/'>ruby/ruby on rails (36)</a></li>
<li class='category'><a href='/blog/categories/rubymine/'>rubymine (1)</a></li>
<li class='category'><a href='/blog/categories/xhtml-css/'>xhtml/css (9)</a></li>
<li class='category'><a href='/blog/categories/工作计划/'>工作计划 (3)</a></li>
<li class='category'><a href='/blog/categories/心情随写/'>心情随写 (67)</a></li>
<li class='category'><a href='/blog/categories/技术感想/'>技术感想 (47)</a></li>
<li class='category'><a href='/blog/categories/未分类/'>未分类 (1)</a></li>
<li class='category'><a href='/blog/categories/杂谈/'>杂谈 (5)</a></li>
<li class='category'><a href='/blog/categories/生活点滴/'>生活点滴 (4)</a></li>
<li class='category'><a href='/blog/categories/软件试用/'>软件试用 (4)</a></li>

  </ul>
</section><section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2014/10/24/rspec-xin-jiu-fang-fa-dui-zhao-biao/">Rspec 新旧方法对照表</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/10/23/rubymine-bu-neng-shu-ru-zhong-wen-%3F/">Rubymine 不能输入中文？</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/10/22/kan-liao-jie-angularjsde-zhi-ling-zhong-de-at-equals/">看了解AngularJs的指令中的@,=</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/10/22/wei-angularjsde-service-shi-dan-li-%3F/">为AngularJs的Service 是单例？</a>
      </li>
    
      <li class="post">
        <a href="/archives/602">为什么说AngularJs的Service是单例？</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/gxbsst">@gxbsst</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'gxbsst',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - Weston Wei(韦旭红) -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'Weixuhong';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
