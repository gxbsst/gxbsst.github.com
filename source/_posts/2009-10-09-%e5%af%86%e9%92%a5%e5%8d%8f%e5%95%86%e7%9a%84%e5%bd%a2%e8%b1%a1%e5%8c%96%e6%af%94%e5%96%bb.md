---
title: 密钥协商的形象化比喻
author: gxbsst
layout: post
permalink: /archives/301
post_views_count:
  - 127
views:
  - 80
categories:
  - Linux/Unix
---
<span style="font-family:STHeiti;">详细</span>: http://www.nsfocus.net/index.php?act=magazine&do=view&mid=841

我<span style="font-family:STHeiti;">们假设</span>A与B通信，A是SSL客<span style="font-family:STHeiti;">户端，</span>B是SSL服<span style="font-family:STHeiti;">务器端，加密后的消息放在方括号</span>[]里，以突出明文消息的区别。双方的<span style="font-family:STHeiti;">处理动作的说明用圆括号（）括起。</span>

A：我想和你安全的通<span style="font-family:STHeiti;">话，我这里的对称加密算法有</span>DES,RC5,密<span style="font-family:STHeiti;">钥交换算法有</span>RSA和DH，摘要算法有MD5和SHA。

B：我<span style="font-family:STHeiti;">们用</span>DES－RSA－SHA<span style="font-family:STHeiti;">这对组合好了。</span>  
<span style="font-family:STHeiti;">这是我的证书，里面有我的名字和公钥，你拿去验证一下我的身份（把证书发给</span>A）。  
目前没有别的可<span style="font-family:STHeiti;">说的了。</span> 

A：（<span style="font-family:STHeiti;">查看证书上</span>B的名字是否无<span style="font-family:STHeiti;">误，并通过手头早已有的</span>CA的<span style="font-family:STHeiti;">证书验证了</span>B的<span style="font-family:STHeiti;">证书的真实性，如果其中一项有误，发出警告并断开连接，这一步保证了</span>B的公<span style="font-family:STHeiti;">钥的真实性）</span>  
（<span style="font-family:STHeiti;">产生一份秘密消息，这份秘密消息处理后将用作加密密钥，加密初始化向量和</span>hmac的密<span style="font-family:STHeiti;">钥。将这份秘密消息</span>-<span style="font-family:STHeiti;">协议中称为</span>per\_master\_secret-用B的公<span style="font-family:STHeiti;">钥加密，封装成称作</span>ClientKeyExchange的消息。由于用了B的公<span style="font-family:STHeiti;">钥，保证了第三方无法窃听）</span>  
我生成了一份秘密消息，并用你的公<span style="font-family:STHeiti;">钥加密了，给你（把</span>ClientKeyExchange<span style="font-family:STHeiti;">发给</span>B）  
注意，下面我就要用加密的<span style="font-family:STHeiti;">办法给你发消息了！</span>  
（将秘密消息<span style="font-family:STHeiti;">进行处理，生成加密密钥，加密初始化向量和</span>hmac的密<span style="font-family:STHeiti;">钥）</span>  
[我<span style="font-family:STHeiti;">说完了</span>]

B：（用自己的私<span style="font-family:STHeiti;">钥将</span>ClientKeyExchange中的秘密消息解密出来，然后将秘密消息<span style="font-family:STHeiti;">进行处理，生成加密密钥，加密初始化向量和</span>hmac的密<span style="font-family:STHeiti;">钥，这时双方已经安全的协商出一套加密办法了）</span>  
注意，我也要开始用加密的<span style="font-family:STHeiti;">办法给你发消息了！</span>  
[我<span style="font-family:STHeiti;">说完了</span>]

A: [我的秘密是...]

B: [其它人不会听到的...] 

转载请注明：[韦旭红的点点滴滴][1] &raquo; [密钥协商的形象化比喻][2]

 [1]: http://www.weixuhong.com
 [2]: http://www.weixuhong.com/archives/301