---
title: PHP 跨站点脚本攻击
author: gxbsst
layout: post
permalink: /archives/172
post_views_count:
  - 116
views:
  - 43
categories:
  - PHP
  - Ruby/Ruby on Rails
---
* http://www.w3pop.com/learn/view/p/5/o//doc/php_xss/  
PHP：用javascript来防止吧  
或者考虑检查 $\_SERVER['HTTP\_REFERER'] * 但是别人是可以修改这个值的，所以不是完全的完全的  
或者用和rails一样的解决方法  
根据一个惟一的字符串或时间戳生成一个令牌，并将这个令牌放在会话变量和表单中  
要创建随机的令牌，可以使用 PHP 内置的 md5()、uniqid() 和 rand() 函数，如下所示：

<pre lang="php"><?php  
session_start();  
  
if ($_POST['submit'] == "go"){  
    //check token  
    if ($_POST['token'] == $_SESSION['token']){  
        //strip_tags  
        $name = strip_tags($_POST['name']);  
        $name = substr($name,0,40);  
        //clean out any potential hexadecimal characters  
        $name = cleanHex($name);  
        //continue processing....  
    }else{  
        //stop all processing! remote form posting attempt!  
    }  
}  
  
$token = md5(uniqid(rand(), true));  
$_SESSION['token']= $token;  
  
  
function cleanHex($input){  
    $clean = preg_replace("![][xX]([A-Fa-f0-9]{1,3})!", "",$input);  
    return $clean;  
}  
?>  
  
  
  
</pre>

Rails: rails2.1在这方面做了些工作，在post数据的时候，会post过去一个安全码，Rails认出来表示正常，否则非法&#8230;

转载请注明：[韦旭红的点点滴滴][1] &raquo; [PHP 跨站点脚本攻击][2]

 [1]: http://www.weixuhong.com
 [2]: http://www.weixuhong.com/archives/172